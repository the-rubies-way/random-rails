#!/usr/bin/env bash
set -euo pipefail
IFS=$'\n\t'
set -vx

# *************************************
# * Install dependencies

# PostgreSQL
if [ -x "$(command -v psql)" ]; then
  echo "PostgreSQL is installed"
  psql -h localhost -p 5432 -W postgres -c 'create database random_rails_test;' -U $(whoami);
else
  echo "PostgreSQL is not installed!"

  exit 1
fi

# MySQL 2
if [ -x "$(command -v mysql)" ]; then
  echo "MySQL is installed"
  mysql -h localhost -P 3306 -u root -e 'create database random_rails_test;'
else
  echo "MySQL is not installed!"

  exit 1
fi

# add sqlite

bundle install
DB=pg bundle exec rspec
